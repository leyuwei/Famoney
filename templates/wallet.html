{{define "content"}}
<h2>{{.Wallet.Name}}</h2>

<h3>{{T "Balance"}}</h3>
<div class="row balance-cards mb-3">
{{range $cur, $bal := .Wallet.Balances}}
  <div class="col-md-3">
    <div class="card text-center">
      <div class="card-body">
        <h5 class="card-title">{{$cur}}</h5>
        <p class="card-text">{{printf "%.2f" $bal}}</p>
      </div>
    </div>
  </div>
{{end}}
</div>

<h3>{{T "Category"}} {{T "Balance"}}</h3>
<table class="table table-bordered w-50">
  <thead><tr><th>{{T "Category"}}</th><th>{{T "Balance"}}</th></tr></thead>
  <tbody>
  {{range $cid, $bal := .Wallet.CategoryBalances}}
    <tr><td>{{(index $.Categories $cid).Name}}</td><td>{{printf "%.2f" $bal}}</td></tr>
  {{else}}
    <tr><td colspan="2">{{T "NoFlows"}}</td></tr>
  {{end}}
  </tbody>
</table>

<details class="mb-4">
<summary>{{T "Add"}} {{T "Amount"}}</summary>
<form method="POST" action="/famoney/wallet/{{.Wallet.ID}}" class="mt-2">
  <input type="hidden" name="action" value="flow">
  <div class="row g-2">
    <div class="col-md-2"><input class="form-control" name="amount" placeholder="{{T "Amount"}}"></div>
    <div class="col-md-2">
      <select name="currency" class="form-select">
        {{range $.Currencies}}
          <option value="{{.}}">{{.}}</option>
        {{end}}
      </select>
    </div>
    <div class="col-md-3">
      <select name="category" class="form-select">
        {{range $id, $c := .Categories}}
          <option value="{{$id}}">{{$c.Name}}</option>
        {{end}}
      </select>
    </div>
    <div class="col-md-3"><input class="form-control" name="description" placeholder="{{T "Description"}}"></div>
    <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">{{T "Add"}}</button></div>
  </div>
</form>
</details>

<details class="mb-4">
<summary>{{T "UpdateBalance"}}</summary>
<form method="POST" action="/famoney/wallet/{{.Wallet.ID}}" class="mt-2">
  <input type="hidden" name="action" value="balance">
  <div class="row g-2">
    <div class="col-md-2"><input class="form-control" name="amount" placeholder="{{T "Balance"}}"></div>
    <div class="col-md-2">
      <select name="currency" class="form-select">
        {{range $.Currencies}}
          <option value="{{.}}">{{.}}</option>
        {{end}}
      </select>
    </div>
    <div class="col-md-3">
      <select name="category" class="form-select">
        {{range $id, $c := .Categories}}
          <option value="{{$id}}">{{$c.Name}}</option>
        {{end}}
      </select>
    </div>
    <div class="col-md-3"><input class="form-control" name="description" placeholder="{{T "Description"}}"></div>
    <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">{{T "Confirm"}}</button></div>
  </div>
</form>
</details>

<details class="mb-4">
<summary>{{T "ShareWallet"}}</summary>
<form method="POST" action="/famoney/wallet/{{.Wallet.ID}}" class="mt-2">
  <input type="hidden" name="action" value="share">
  <div class="row g-2">
    <div class="col-md-6"><input class="form-control" name="username" list="userlist" placeholder="{{T "Username"}}"></div>
    <datalist id="userlist">
      {{range .Users}}<option value="{{.}}">{{.}}</option>{{end}}
    </datalist>
    <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">{{T "Share"}}</button></div>
  </div>
</form>
</details>

<details class="mb-4">
<summary>{{T "EditWallet"}}</summary>
<form method="POST" action="/famoney/wallet/{{.Wallet.ID}}" class="mt-2">
  <input type="hidden" name="action" value="rename">
  <div class="row g-2">
    <div class="col-md-6"><input class="form-control" name="name" value="{{.Wallet.Name}}"></div>
    <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">{{T "Edit"}}</button></div>
  </div>
</form>
</details>

<h3>{{T "Flows"}}</h3>
<table class="table table-striped">
<thead><tr><th>{{T "Amount"}}</th><th>{{T "Category"}}</th><th>{{T "Description"}}</th><th>{{T "Operator"}}</th><th>{{T "Time"}}</th><th>{{T "Actions"}}</th></tr></thead>
<tbody>
{{range .Flows}}
<tr>
  <td>{{.Amount}}</td>
  <td>{{(index $.Categories .CategoryID).Name}}</td>
  <td>{{.Description}}</td>
  <td>{{.Operator}}</td>
  <td>{{.CreatedAt}}</td>
  <td>
    <a href="/famoney/flow/{{.ID}}/edit" class="btn btn-sm btn-secondary">{{T "Edit"}}</a>
    <form method="POST" action="/famoney/flow/{{.ID}}/delete" class="d-inline">
      <button type="submit" class="btn btn-sm btn-danger">{{T "Delete"}}</button>
    </form>
  </td>
</tr>
{{else}}
<tr><td colspan="6">{{T "NoFlows"}}</td></tr>
{{end}}
</tbody>
</table>

<form method="POST" action="/famoney/wallet/{{.Wallet.ID}}/delete" class="mt-4" onsubmit="return confirm('{{T "Confirm"}}');">
  <button type="submit" class="btn btn-danger">{{T "Delete"}}</button>
</form>
{{end}}

